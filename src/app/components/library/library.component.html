<div class="library-container">
  <app-song-collection
    #songCollection
    [config]="libraryCollectionConfig()"
    [emptyStateTemplate]="currentEmptyStateTemplate()"
    [showBackToTop]="true"
    (tileClick)="onSongCardClick($event)"
    (deleteClick)="onSongDeleteClick($event)"
    (viewStateChange)="onCollectionStateChange($event)"
  ></app-song-collection>

  <ng-template #libraryEmptyState>
    <div class="empty-state-wrapper">
      <app-empty-state [message]="'Your library is empty'" [iconName]="'queue_music'">
        <div class="empty-state-actions">
          <button mat-flat-button (click)="onUploadClick()">
            <mat-icon>cloud_upload</mat-icon>
            Upload Your Music
          </button>
          <button mat-button [routerLink]="['/app/discover']">
            <mat-icon>explore</mat-icon>
            Browse Public Library
          </button>
        </div>
      </app-empty-state>
    </div>
  </ng-template>

  <ng-template #librarySearchEmptyState>
    <div class="empty-state-wrapper">
      <app-empty-state
        [message]="'No songs found'"
        [description]="'Try adjusting your search terms or browse all songs in your library'"
        [iconName]="'search_off'"
      >
        <div class="empty-state-actions">
          <button mat-button (click)="onClearSearch()">
            <mat-icon>clear</mat-icon>
            Clear Search
          </button>
          <button mat-button [routerLink]="['/app/discover']">
            <mat-icon>explore</mat-icon>
            Browse Public Library
          </button>
        </div>
      </app-empty-state>
    </div>
  </ng-template>

  <div class="fab-container floating-fab-right">
    @if (!collectionState().isLoading && !collectionState().isEmpty) {
      <button
        mat-fab
        class="upload-fab floating-fab"
        (click)="onUploadClick()"
        aria-label="Upload a new song"
      >
        <mat-icon>cloud_upload</mat-icon>
      </button>
    }

    @if (!collectionState().isLoading && canFindSimilar()) {
      <button
        mat-fab
        class="find-similar-fab floating-fab"
        (click)="onFindSimilarClick()"
        aria-label="Find similar music"
      >
        <mat-icon>lightbulb</mat-icon>
      </button>
    }
  </div>
</div>
