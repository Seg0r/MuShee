<main class="discover-container">
  <!-- Header -->
  <div class="discover-header">
    <h1>Discover</h1>
  </div>

  <!-- Loading State -->
  @if (isInitialLoading()) {
    <div class="loading-state">
      <app-loading-skeleton [count]="skeletonCount()" />
    </div>
  } @else {
    <!-- Songs Grid -->
    <div #scrollContainer class="scroll-container">
      <div class="songs-grid">
        @for (song of visibleSongs(); track song.id) {
          <app-song-tile
            [song]="song"
            [config]="getSongTileConfig(song)"
            (tileClick)="onSongCardClick(song)"
            (addToLibrary)="onAddToLibrary(song)"
          />
        }
      </div>

      <!-- Pagination Loading Indicator -->
      @if (isPaginationLoading()) {
        <div class="pagination-loading">
          <mat-spinner diameter="40"></mat-spinner>
          <p>Loading more songs...</p>
        </div>
      }
    </div>

    <!-- Back to Top FAB -->
    @if (isBackToTopVisible()) {
      <button matFab (click)="scrollToTop()" class="back-to-top-fab" aria-label="Scroll to top">
        <mat-icon>arrow_upward</mat-icon>
      </button>
    }
  }

  <!-- Error State -->
  @if (error()) {
    <div class="error-banner">
      <p>{{ error()!.message }}</p>
      <button matButton (click)="retryInitialize()">Retry</button>
    </div>
  }
</main>
